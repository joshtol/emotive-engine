(function() { 'use strict'; const config = { assetsConfig: 'js/config/assets-config.js', scripts: [ 'js/ui/theme-manager.js', 'js/ui/display-manager.js', 'js/ui/dice-roller.js', 'js/ui/dj-scratcher.js', 'js/ui/audio-visualizer.js', 'js/controls/randomizer-controller.js', 'js/controls/gesture-chain-controller.js', 'js/controls/undertone-controller.js', 'js/controls/system-controls-controller.js', 'js/controls/emotion-controller.js', 'js/controls/shape-morph-controller.js', 'js/controls/audio-controller.js', 'js/controls/dice-controller.js', 'js/controls/gesture-controller.js', 'js/controls/orientation-controller.js', 'js/config/ui-strings.js', 'js/core/global-state.js', 'js/core/module-loader.js', 'js/core/legacy-compatibility.js', 'js/core/app.js', 'js/core/app-bootstrap.js' ], fonts: { preconnect: [ 'https: 'https: ], url: 'https: }, favicon: '../assets/emotive-engine-icon.svg', headerLogo: '../assets/emotive-engine-full-BW.svg', mainStylesheet: 'emotive-scifi-modular.css', version: '1.0.0' }; function loadScript(src) { return new Promise((resolve, reject) => { const script = document.createElement('script'); script.src = src + '?v=' + config.version; script.onload = resolve; script.onerror = reject; document.body.appendChild(script); }); } function setupFonts() { config.fonts.preconnect.forEach(url => { const link = document.createElement('link'); link.rel = 'preconnect'; link.href = url; if (url.includes('gstatic')) { link.crossOrigin = 'anonymous'; } document.head.appendChild(link); }); const fontLink = document.createElement('link'); fontLink.rel = 'stylesheet'; fontLink.href = config.fonts.url; document.head.appendChild(fontLink); } function setupFavicon() { let favicon = document.querySelector('link[rel="icon"]'); if (!favicon) { favicon = document.createElement('link'); favicon.rel = 'icon'; favicon.type = 'image/svg+xml'; document.head.appendChild(favicon); } favicon.href = config.favicon + '?v=' + config.version; } function setupStylesheet() { let stylesheet = document.querySelector('link[href*="emotive-scifi"]'); if (!stylesheet) { stylesheet = document.createElement('link'); stylesheet.rel = 'stylesheet'; document.head.appendChild(stylesheet); } stylesheet.href = config.mainStylesheet + '?v=' + config.version; } async function init() { try { setupFonts(); setupFavicon(); setupStylesheet(); await loadScript(config.assetsConfig); if (window.AssetsConfig) { window.assetsConfig = new window.AssetsConfig({ cacheVersion: config.version, images: { favicon: config.favicon, headerLogo: config.headerLogo } }); window.assetsConfig.init(); } for (const script of config.scripts) { await loadScript(script); } console.log('Bootstrap loader completed'); } catch (error) { console.error('Bootstrap loader failed:', error); } } if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', init); } else { init(); } })();