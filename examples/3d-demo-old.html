<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotive Engine 3D Demo</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            margin: 20px 0;
            font-size: 2em;
            text-align: center;
        }

        .container {
            display: flex;
            gap: 40px;
            align-items: flex-start;
            max-width: 1200px;
            width: 100%;
        }

        .canvas-container {
            position: relative;
            flex: 1;
        }

        #mascot-canvas {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
        }

        /* Make the container visible for debugging */
        .canvas-container > div {
            background: rgba(100, 100, 255, 0.1) !important;
        }

        .controls {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            min-width: 250px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group h3 {
            margin: 0 0 10px 0;
            font-size: 1em;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 16px;
            margin: 4px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-1px);
        }

        button:active {
            transform: translateY(0);
        }

        .info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
        }

        .info code {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        #status {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 255, 0, 0.1);
            border-radius: 6px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>🎭 Emotive Engine 3D - Experimental WebGL Rendering</h1>

    <div class="container">
        <div class="canvas-container">
            <canvas id="mascot-canvas" width="800" height="800"></canvas>
        </div>

        <div class="controls">
            <div class="control-group">
                <h3>Geometries</h3>
                <button data-action="geometry" data-value="sphere">Sphere</button>
                <button data-action="geometry" data-value="crystal">Crystal</button>
                <button data-action="geometry" data-value="diamond">Diamond</button>
            </div>

            <div class="control-group">
                <h3>Emotions</h3>
                <button data-action="emotion" data-value="joy">Joy</button>
                <button data-action="emotion" data-value="love">Love</button>
                <button data-action="emotion" data-value="excited">Excited</button>
                <button data-action="emotion" data-value="euphoria">Euphoria</button>
                <button data-action="emotion" data-value="calm">Calm</button>
                <button data-action="emotion" data-value="focused">Focused</button>
                <button data-action="emotion" data-value="resting">Resting</button>
                <button data-action="emotion" data-value="sadness">Sadness</button>
                <button data-action="emotion" data-value="anger">Anger</button>
                <button data-action="emotion" data-value="fear">Fear</button>
                <button data-action="emotion" data-value="surprise">Surprise</button>
                <button data-action="emotion" data-value="suspicion">Suspicion</button>
                <button data-action="emotion" data-value="disgust">Disgust</button>
                <button data-action="emotion" data-value="neutral">Neutral</button>
                <button data-action="emotion" data-value="glitch">Glitch</button>
            </div>

            <div class="control-group">
                <h3>Undertones</h3>
                <button data-action="undertone" data-value="null">None</button>
                <button data-action="undertone" data-value="subdued">Subdued</button>
                <button data-action="undertone" data-value="tired">Tired</button>
                <button data-action="undertone" data-value="nervous">Nervous</button>
                <button data-action="undertone" data-value="energetic">Energetic</button>
                <button data-action="undertone" data-value="confident">Confident</button>
                <button data-action="undertone" data-value="intense">Intense</button>
            </div>

            <div class="control-group">
                <h3>Dance Gestures</h3>
                <button data-action="gesture" data-value="headBob">HeadBob</button>
                <button data-action="gesture" data-value="wiggle">Wiggle</button>
                <button data-action="gesture" data-value="orbit">Orbit</button>
                <button data-action="gesture" data-value="groove">Groove</button>
                <button data-action="gesture" data-value="point">Point</button>
                <button data-action="gesture" data-value="lean">Lean</button>
                <button data-action="gesture" data-value="reach">Reach</button>
                <button data-action="gesture" data-value="runningman">RunMan</button>
                <button data-action="gesture" data-value="charleston">Charleston</button>
            </div>

            <div class="control-group">
                <h3>Overlay Gestures</h3>
                <button data-action="gesture" data-value="bounce">Bounce</button>
                <button data-action="gesture" data-value="sway">Sway</button>
                <button data-action="gesture" data-value="spin">Spin</button>
                <button data-action="gesture" data-value="hula">Hula</button>
                <button data-action="gesture" data-value="jump">Jump</button>
                <button data-action="gesture" data-value="twist">Twist</button>
                <button data-action="gesture" data-value="wave">Wave</button>
                <button data-action="gesture" data-value="nod">Nod</button>
                <button data-action="gesture" data-value="shake">Shake</button>
                <button data-action="gesture" data-value="tilt">Tilt</button>
                <button data-action="gesture" data-value="breathe">Breathe</button>
                <button data-action="gesture" data-value="float">Float</button>
            </div>

            <div class="control-group">
                <h3>Glow Effects</h3>
                <button data-action="gesture" data-value="sparkle">Sparkle</button>
                <button data-action="gesture" data-value="pulse">Pulse</button>
                <button data-action="gesture" data-value="glow">Glow</button>
                <button data-action="gesture" data-value="flash">Flash</button>
                <button data-action="gesture" data-value="shimmer">Shimmer</button>
                <button data-action="gesture" data-value="flicker">Flicker</button>
            </div>

            <div class="control-group">
                <h3>Combo Chains</h3>
                <button data-action="chain" data-value="rise">Rise</button>
                <button data-action="chain" data-value="flow">Flow</button>
                <button data-action="chain" data-value="burst">Burst</button>
                <button data-action="chain" data-value="drift">Drift</button>
                <button data-action="chain" data-value="chaos">Chaos</button>
                <button data-action="chain" data-value="morph">Morph</button>
                <button data-action="chain" data-value="rhythm">Rhythm</button>
                <button data-action="chain" data-value="spiral">Spiral</button>
                <button data-action="chain" data-value="routine">Routine</button>
                <button data-action="chain" data-value="radiance">Radiance</button>
                <button data-action="chain" data-value="twinkle">Twinkle</button>
                <button data-action="chain" data-value="stream">Stream</button>
            </div>


            <div id="status">Initializing...</div>

            <div class="info">
                <strong>About:</strong><br>
                Custom 3D rendering with:<br>
                • WebGL 2.0 renderer (no Three.js)<br>
                • Procedural 3D geometries<br>
                • Shader-based glow effects<br>
                • Procedural animations<br>
                • Same API as 2D version<br>
                • Bundle size: ~151KB (~41KB gzipped)<br><br>
                <code>new EmotiveMascot3D()</code>
            </div>
        </div>
    </div>

    <script type="module">
        import { EmotiveMascot3D } from '../dist/emotive-mascot-3d.js?v=8';

        let mascot = null;

        // Initialize 3D mascot
        (async () => {
            try {
                const canvas = document.getElementById('mascot-canvas');
                mascot = new EmotiveMascot3D({
                    coreGeometry: 'crystal',
                    enableParticles: true  // Enable particles!
                });

                await mascot.init(canvas);
                mascot.start();

                // Set initial emotion
                mascot.setEmotion('joy');

                document.getElementById('status').textContent = '✅ Ready!';
                document.getElementById('status').style.background = 'rgba(0, 255, 0, 0.2)';

                console.log('✅ EmotiveMascot3D initialized');
                console.log('Available geometries:', ['sphere', 'crystal', 'diamond']);
            } catch (error) {
                console.error('Failed to initialize:', error);
                document.getElementById('status').textContent = '❌ Error: ' + error.message;
                document.getElementById('status').style.background = 'rgba(255, 0, 0, 0.2)';
            }
        })();

        // Event delegation for all buttons
        document.addEventListener('click', (e) => {
            if (!e.target.matches('button[data-action]') || !mascot) return;

            const action = e.target.dataset.action;
            const value = e.target.dataset.value;

            try {
                switch (action) {
                    case 'geometry':
                        console.log('Morphing to:', value);
                        mascot.morphTo(value);
                        break;

                    case 'emotion':
                        console.log('Setting emotion:', value);
                        mascot.setEmotion(value);
                        break;

                    case 'gesture':
                        console.log('Playing gesture:', value);
                        mascot.express(value);
                        break;

                    case 'undertone':
                        const undertone = value === 'null' ? null : value;
                        console.log('Setting undertone:', undertone);
                        mascot.updateUndertone(undertone);
                        break;

                    case 'chain':
                        console.log('Playing chain combo:', value);
                        if (mascot.chain) {
                            mascot.chain(value);
                        } else {
                            console.warn('chain() method not yet implemented in 3D engine');
                        }
                        break;
                }
            } catch (error) {
                console.error('Action failed:', error);
            }
        });
    </script>
</body>
</html>
